DROP TABLE IF EXISTS DRUZYNA
DROP TABLE IF EXISTS KLASYFIKACJA
DROP TABLE IF EXISTS SPORTOWIEC
DROP TABLE IF EXISTS REPREZENTACJA
DROP TABLE IF EXISTS PREMIE
DROP TABLE IF EXISTS ROZEGRANIE
DROP TABLE IF EXISTS KONKURENCJA
DROP TABLE IF EXISTS OBIEKT
DROP TABLE IF EXISTS SPONSOR
DROP TABLE IF EXISTS IGRZYSKA


CREATE TABLE IGRZYSKA (
	ROK INTEGER PRIMARY KEY,
	DATA_ROZPOCZECIA DATE NOT NULL,
	DATA_ZAKONCZENIA DATE NOT NULL,
	NUMER INTEGER NOT NULL,
	KRAJ VARCHAR(255)NOT NULL,
	MIASTO_GOSPODARZ VARCHAR(255) NOT NULL,
	MASKOTKA VARCHAR(255),
	CONSTRAINT ogr1 CHECK(1850<ROK),
	CONSTRAINT ogr2 CHECK(2500>ROK)
);

CREATE TABLE SPONSOR (
	ROK INTEGER,
	NAZWA VARCHAR(255) PRIMARY KEY NOT NULL,
	RODZAJ_WSPARCIA VARCHAR(255),
	FOREIGN KEY (ROK) REFERENCES IGRZYSKA(ROK) ON UPDATE CASCADE ON DELETE CASCADE
);
CREATE TABLE OBIEKT (
	NAZWA VARCHAR(255) PRIMARY KEY,
	POJEMNOSC INTEGER,
	MIASTO VARCHAR(255) NOT NULL
);
CREATE TABLE KONKURENCJA (
	NAZWA VARCHAR(255) PRIMARY KEY,
	DYSCYPLINA VARCHAR(255) NOT NULL,
	REKORD INTEGER NULL

);

CREATE TABLE ROZEGRANIE (
	NR INTEGER PRIMARY KEY IDENTITY(1,1),
	ROK INTEGER NOT NULL,
	NAZWA_MIEJSCA VARCHAR(255) FOREIGN KEY (NAZWA_MIEJSCA) REFERENCES OBIEKT(NAZWA) ON UPDATE CASCADE ON DELETE CASCADE,
	NAZWA_KONKURENCJI VARCHAR(255) FOREIGN KEY (NAZWA_KONKURENCJI) REFERENCES KONKURENCJA(NAZWA) ON UPDATE CASCADE ON DELETE CASCADE,
	CONSTRAINT ogr3 CHECK(1850<ROK),
	CONSTRAINT ogr4 CHECK(2500>ROK)
);


CREATE TABLE PREMIE (
 ROK INTEGER PRIMARY KEY,
 I_MIEJSCE_INDYWIDUALNIE INTEGER NOT NULL,
 II_MIEJSCE_INDYWIDUALNIE INTEGER NOT NULL,
 III_MIEJSCE_INDYWIDUALNIE INTEGER NOT NULL,
 I_MIEJSCE_DRUZYNOWO INTEGER NOT NULL,
 II_MIEJSCE_DRUZYNOWO INTEGER NOT NULL,
 III_MIEJSCE_DRUZYNOWO INTEGER NOT NULL,
 FOREIGN KEY (ROK) REFERENCES IGRZYSKA(ROK) ON UPDATE CASCADE ON DELETE CASCADE
);


CREATE TABLE REPREZENTACJA (
	NAZWA VARCHAR(255) PRIMARY KEY NOT NULL,
	MIEJSCE_W_KLASYFKIACJI_MEDALOWEJ INTEGER NOT NULL,
	ILOSC_MEDALI INTEGER,
	ZAROBER_SUMARYCZNY INTEGER,
	ILOSC_REPREZENTANTOW INTEGER,
	ROK INTEGER FOREIGN KEY (ROK) REFERENCES IGRZYSKA(ROK) ON UPDATE CASCADE ON DELETE CASCADE
);

CREATE TABLE SPORTOWIEC (
	ID INTEGER PRIMARY KEY IDENTITY(1,1),
	KRAJ VARCHAR(255) FOREIGN KEY (KRAJ) REFERENCES REPREZENTACJA(NAZWA) ON UPDATE CASCADE ON DELETE CASCADE,
	IMIE VARCHAR(255) NOT NULL,
	NAZWISKO VARCHAR(255) NOT NULL,
	ZAROBEK INTEGER,
	ILOSC_MEDALI INTEGER,
	WIEK INTEGER NOT NULL,
);

CREATE TABLE KLASYFIKACJA (
	NUMER INTEGER IDENTITY(1,1) FOREIGN KEY (NUMER) REFERENCES ROZEGRANIE(NR),
	ROK INTEGER NOT NULL,
	MIEJSCE INTEGER NOT NULL,
	WYNIK INTEGER  NULL,
	ID INTEGER NOT NULL,
	FOREIGN KEY (ROK) REFERENCES IGRZYSKA(ROK) ON UPDATE CASCADE ON DELETE CASCADE,
	FOREIGN KEY (ROK) REFERENCES PREMIE(ROK) ON UPDATE NO ACTION ON DELETE NO ACTION,
	FOREIGN KEY (ID) REFERENCES SPORTOWIEC(ID),
);

CREATE TABLE DRUZYNA (
 ROK INTEGER NOT NULL,
 LICZNOSC_DRUZYNY INTEGER NOT NULL,
 NAZWA_KONKURENCJI VARCHAR(255) NOT NULL,
 NAZWA_NARODOWOSCI VARCHAR(255) PRIMARY KEY,
 FOREIGN KEY (ROK) REFERENCES IGRZYSKA(ROK) ON UPDATE CASCADE ON DELETE CASCADE,
 FOREIGN KEY (NAZWA_KONKURENCJI) REFERENCES KONKURENCJA(NAZWA),
 FOREIGN KEY (NAZWA_NARODOWOSCI) REFERENCES REPREZENTACJA(NAZWA),
);
